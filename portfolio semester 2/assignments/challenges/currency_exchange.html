<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
    <title>Currency Converter</title>
<style>
.remove {
    display: none;
}
</style>
<body>
    <h1>Select a Currency to exchange</h1>

    <label for="base_currency">From</label>
    <select name="base_currency" id="base_currency">
        <option disabled selected value>-</option>
        <option value="AUD">AUD</option>
        <option value="BGN">BGN</option>
        <option value="BRL">BRL</option>
        <option value="CAD">CAD</option>
        <option value="CHF">CHF</option>
        <option value="CNY">CNY</option>
        <option value="CZK">CZK</option>
        <option value="DKK">DKK</option>
        <option value="EUR">EUR</option>
        <option value="GBP">GBP</option>
        <option value="HKD">HKD</option>
        <option value="HRK">HRK</option>
        <option value="HUF">HUF</option>
        <option value="IDR">IDR</option>
        <option value="ILS">ILS</option>
        <option value="ISK">ISK</option>
        <option value="JPY">JPY</option>
        <option value="KRW">KRW</option>
        <option value="MXN">MXN</option>
        <option value="MYR">MYR</option>
        <option value="NOK">NOK</option>
        <option value="NZD">NZD</option>
        <option value="PHP">PHP</option>
        <option value="PLN">PLN</option>
        <option value="RON">RON</option>
        <option value="RUB">RUB</option>
        <option value="SEK">SEK</option>
        <option value="SGD">SGD</option>
        <option value="THB">THB</option>
        <option value="TRY">TRY</option>
        <option value="USD">USD</option>
        <option value="ZAR">ZAR</option>
    </select>

    <label for="exchange_currency">to</label>
    <select name="exchange_currency" id="exchange_currency">
        <option disabled selected value>-</option>
        <option value="AUD">AUD</option>
        <option value="BGN">BGN</option>
        <option value="BRL">BRL</option>
        <option value="CAD">CAD</option>
        <option value="CHF">CHF</option>
        <option value="CNY">CNY</option>
        <option value="CZK">CZK</option>
        <option value="DKK">DKK</option>
        <option value="EUR">EUR</option>
        <option value="GBP">GBP</option>
        <option value="HKD">HKD</option>
        <option value="HRK">HRK</option>
        <option value="HUF">HUF</option>
        <option value="IDR">IDR</option>
        <option value="ILS">ILS</option>
        <option value="ISK">ISK</option>
        <option value="JPY">JPY</option>
        <option value="KRW">KRW</option>
        <option value="MXN">MXN</option>
        <option value="MYR">MYR</option>
        <option value="NOK">NOK</option>
        <option value="NZD">NZD</option>
        <option value="PHP">PHP</option>
        <option value="PLN">PLN</option>
        <option value="RON">RON</option>
        <option value="RUB">RUB</option>
        <option value="SEK">SEK</option>
        <option value="SGD">SGD</option>
        <option value="THB">THB</option>
        <option value="TRY">TRY</option>
        <option value="USD">USD</option>
        <option value="ZAR">ZAR</option>
    </select>

    <label for="amount">Amount:</label>
    <input id="amount" type="number" size="4">
    <br>
    <br>
    <button onclick="exchange()">Exchange</button>
    <p id="exchange_result"></p>
    <p class="remove" id="err_msg" style="color:red">Please select a currency to exchange from and to and indicate an amount bigger than 0</p>
<script>
function exchange(){
    // resets all errors 
    $("#err_msg").addClass("remove")
    $("#base_currency").css("background-color", "")
    $("#exchange_currency").css("background-color", "")
    $("#amount").css("background-color", "")

    baseCurrency = $("#base_currency").val()
    exchangeCurrency = $("#exchange_currency").val()
    exchangeAmount = $("#amount").val()

    // error message if incorrect data
    if(baseCurrency == null || exchangeCurrency == null || exchangeAmount <= 0){
        if(baseCurrency == null){
            $("#base_currency").css("background-color", "rgba(255, 0, 0, 0.2)")
        }
        if(exchangeCurrency == null){
            $("#exchange_currency").css("background-color", "rgba(255, 0, 0, 0.2)")
        }
        if(exchangeAmount <= 0){
            $("#amount").css("background-color", "rgba(255, 0, 0, 0.2)")
        }

        $("#err_msg").removeClass("remove")
        return
    }

    // if currency is the same, doesn't run function, if different, runs API call
    if(baseCurrency == exchangeCurrency){
        $("#exchange_result").text(`${exchangeAmount} ${baseCurrency} = ${exchangeAmount} ${baseCurrency}`)
    }else{
        convertCurrency(baseCurrency,exchangeCurrency,exchangeAmount)
    }
}

// currency exchange api call
function convertCurrency(baseCurrency,exchangeCurrency,amount) {
  var exchange_result
  fetch(`https://api.freecurrencyapi.com/v1/latest?apikey=Aj9RHnGZ4TxYvbdDkx4iHMpwuSLE9GuALrkH0DKn&currencies=${exchangeCurrency}&base_currency=${baseCurrency}`)
    .then(response => response.json())
    .then(data => {
        exchange_result = data.data[exchangeCurrency] * Number(amount)
        $("#exchange_result").text(`${exchangeAmount} ${baseCurrency} = ${exchange_result} ${exchangeCurrency}`)
      debugger;
    })
    .catch(error => {
      console.log('An error occurred:', error);
    });
}
</script>
</body>
</html>